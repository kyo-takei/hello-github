<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>QA・品質管理のAI活用</title>
<style>
  :root { --ease: cubic-bezier(.25,.1,.25,1); }
  * { box-sizing: border-box; }
  html { scroll-behavior: smooth; }

  /* ===== 全体背景：単色の淡い水色 ===== */
  body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Hiragino Sans", "Noto Sans JP", sans-serif;
    background: #eaf6ff;
    color: #222;
    overflow-x: hidden;
  }

  header {
    position: sticky; top: 0; z-index: 50;
    backdrop-filter: blur(10px);
    background: rgba(240,240,240,0.6);
    border-bottom: 1px solid rgba(0,0,0,.05);
    text-align: center; padding: 10px 0;
    font-weight: 600; letter-spacing: .05em;
  }

  /* ===== ヒーロー（画像タグで“切れない”表示） ===== */
  .hero{
    width:100%;
    border-bottom: 6px solid #111;
    box-shadow: inset 0 -40px 40px rgba(0,0,0,0.18);
    background:#111;
  }
  .hero-img{
    display:block;
    width:100%;
    height:auto;
  }
  .visually-hidden{
    position:absolute !important; width:1px; height:1px; margin:-1px; border:0; padding:0;
    white-space:nowrap; clip-path:inset(50%); clip:rect(0 0 0 0); overflow:hidden;
  }

  /* ===== 自己紹介 ===== */
  .profile{
    max-width:800px; width:90%;
    background:#fff;
    border-radius:16px;
    box-shadow:0 12px 40px rgba(0,0,0,0.12);
    padding:40px 28px;
    text-align:center;
    margin:24px auto 0;
    position:relative; z-index:5;
  }
  .profile h2{ margin:0 0 8px; font-size:24px; }
  .profile p{ color:#555; line-height:1.8; margin:4px 0; }

  /* ===== 1行スライドアニメ ===== */
  .ticker{ height:1.8em; overflow:hidden; display:inline-block; }
  .ticker .track{
    display:flex; flex-direction:column;
    line-height:1.8em;
    animation:tick 9s steps(3) infinite;
  }
  @keyframes tick{
    0%{ transform:translateY(0); }
    100%{ transform:translateY(-5.4em); }
  }

  /* ===== 共通セクション ===== */
  main{
    display:flex; flex-direction:column; align-items:center;
    gap:70px; padding:40px 0 140px;
  }
  section{
    width:100%; max-width:760px; background:#fff;
    border-radius:16px; overflow:hidden;
    transform:translateY(80px) scale(0.95);
    opacity:0;
    box-shadow:0 0 0 rgba(0,0,0,0);
    will-change:transform, opacity, box-shadow;
    transition:
      transform 1.4s var(--ease),
      opacity 1.4s var(--ease),
      box-shadow 1.0s var(--ease) 0.25s;
  }
  section.is-in{
    transform:translateY(0) scale(1);
    opacity:1;
    box-shadow:
      0 25px 70px rgba(0,0,0,0.28),
      0 10px 20px rgba(0,0,0,0.15);
  }
  img{ display:block; width:100%; height:auto; user-select:none; pointer-events:none; }

  /* ===== 画像スタック（新規） ===== */
  .stack-box{
    background:#fff;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,0.06);
    padding:28px 36px;margin-bottom:28px;
  }
  .stack-img{
    border-radius:12px; box-shadow:0 10px 24px rgba(0,0,0,0.12);
    margin:10px 0 12px;
  }
  .stack-caption{ color:#444; margin:8px 0 0; }

  /* ===== コード折りたたみ（新規） ===== */
  details{
    background:#fff; border-radius:12px; box-shadow:0 4px 18px rgba(0,0,0,.06);
    padding:12px 14px; margin:12px 0;
  }
  details summary{
    cursor:pointer; list-style:none; font-weight:700; color:#10324a;
  }
  details summary::-webkit-details-marker { display:none; }
  .codebox{
    background:#0f172a; color:#e5e7eb; border-radius:10px; padding:14px;
    overflow:auto; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    font-size:13px; line-height:1.6; margin-top:10px; white-space:pre-wrap; word-break:break-word;
  }

  @media (max-width:768px){
    main{ gap:50px; padding:30px 0 100px; }
    section, .profile{ border-radius:12px; }
  }
</style>
</head>
<body>
  <header>QA・品質管理のAI活用</header>

  <!-- ヒーロー -->
  <div class="hero">
    <img src="title.png" alt="非エンジニアでもAIここまでできる！" class="hero-img">
    <h1 class="visually-hidden">QA・品質管理のAI活用</h1>
  </div>

  <!-- 自己紹介 -->
  <div class="profile reveal">
    <h2>@kyo-chan</h2>
    <p>
      <span class="ticker">
        <span class="track">
          <span>Contents & Training Management（CTM）所属 </span>
          <span>AI×業務設計で“再現性ある自動化”を構築</span>
          <span>Team内のAI Native化を目指し日々奮闘中</span>
        </span>
      </span>
    </p>
    <p>「AIと人の強みを融合して、MP全体の品質を次のステージへ」</p>
  </div>

  <main>
    <!-- 漫画コマ -->
    <section class="reveal"><img src="1.png" alt="comic1" loading="lazy"></section>
    <section class="reveal"><img src="2.png" alt="comic2" loading="lazy"></section>
    <section class="reveal"><img src="3.png" alt="comic3" loading="lazy"></section>
    <section class="reveal"><img src="4.png" alt="comic4" loading="lazy"></section>
    <section class="reveal"><img src="5.png" alt="comic5" loading="lazy"></section>
    <section class="reveal"><img src="6.png" alt="comic6" loading="lazy"></section>

    <!-- 品質管理AI化の取り組み背景 -->
    <section class="reveal" id="ai-qa" style="width:100%;max-width:1080px;background:#ffffff;border-radius:20px;padding:60px 40px;margin-top:80px;margin-bottom:60px;box-shadow:0 6px 20px rgba(0,0,0,0.08);">
      <h2 style="font-size:36px;font-weight:800;margin:0 0 40px;text-align:center;color:#111;">
        品質管理AI化の取り組み背景
      </h2>

      <!-- 背景と課題 -->
      <div style="background:#fff;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,0.06);padding:32px 40px;margin-bottom:32px;">
        <h3 style="margin:0 0 10px;font-size:20px;border-left:6px solid #111;padding-left:10px;">背景と課題</h3>
        <ul style="margin:8px 0 0 18px;color:#333;line-height:1.8;">
          <li>委託先に入信対応のサンプリングチェックを依頼し、IHでダブルチェックを実施していたが、チェック項目が多く、1件あたり約30分の工数になっていた。</li>
          <li>7月にAIチャンネルやWBRでシェアした
            <strong>
              <a href="https://chatgpt.com/g/g-6875b677f42c81b8a8bfe0ed6c477b94-tenhurepin-zhi-tietuka"
                 target="_blank" rel="noopener noreferrer"
                 style="color:#0070f3;text-decoration:none;border-bottom:1px solid rgba(0,112,243,0.4);">
                 Template Quality Checker
              </a>
            </strong>
            というカスタムGPTを利用することで、一部AI化していたが、工数としては50%程度の削減かつ、入信や返信文を手作業でコピーする手間が残っていた。
          </li>
          <li>委託先とIH間で品質基準の認識にギャップがあり、正しいAccuracyが可視化できておらず、CalibrationやFBでは安定化に限界。</li>
          <li>より効率的で再現性と品質を担保出来る仕組み構築が必要だった。</li>
        </ul>
      </div>

      <!-- 取り組み概要 -->
      <div style="background:#fff;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,0.06);padding:32px 40px;margin-bottom:32px;">
        <h3 style="margin:0 0 10px;font-size:20px;border-left:6px solid #111;padding-left:10px;">AI活用概要</h3>
        <ul style="margin:8px 0 0 18px;color:#333;line-height:1.8;">
          <li>サンプルチェック用の案件の入信/返信文を<strong>個人情報保護フォルダへ毎日自動抽出</strong>する仕組みを構築。</li>
           <ul>
          <li><strong>Special Thanks @UcchiYさん</strong>のご協力により実現。</li>
            </ul>
          <li>委託先には<strong>プロセスチェックのみ</strong>依頼（1件3分）。ツール処理やフロー判断はAIではなく人が担当。</li>
          <li>AIに相談することで、<strong>案件→chatGPT取り込み→スプシ吐き出し→slack通知をGAS連携</strong>ができ、<strong>ワンクリック放置運用</strong>実現。</li>
        </ul>
      </div>

      <!-- 成果 -->
      <div style="background:#fff;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,0.06);padding:32px 40px;margin-bottom:32px;">
        <h3 style="margin:0 0 10px;font-size:20px;border-left:6px solid #111;padding-left:10px;">成果</h3>
        <ul style="margin:0 0 0 20px;color:#333;line-height:1.8;">
          <li>サンプルチェックの時間を、<strong>約1000分の1に爆速化！！</strong></li>
          <ul><li><strong>500件</strong>のAudit＋評価記載を<strong>15分</strong>で完了（従来約<strong>250h</strong>）。</li> </ul>
          <li>委託先のAccuracy 80% → AI分析で<strong>実測30%</strong>が発覚、品質可視化に前進。</li>
          <li>品質評価をAIに任せることで、一貫性かつ再現性あるAudit運用を確立。</li>
        </ul>
      </div>

      <!-- 課題とNext Action -->
      <div style="background:#fff;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,0.06);padding:32px 40px;">
        <h3 style="margin:0 0 10px;font-size:20px;border-left:6px solid #111;padding-left:10px;">課題とNext Action</h3>
        <ul style="margin:0 0 0 20px;color:#333;line-height:1.8;">
          <li>誤対応件数の増加に伴う委託先の<strong>管理者負荷</strong>対策。</li>
          <li>AIの<strong>誤判定（現状精度：約85%）</strong>があり、委託先からのRebuttal起点でのプロンプト調整に対する再学習/チューニング。</li>
          <ul><li> <li><strong>Special Thanks @Hikichiさん</strong>のご協力により実現。</li></ul>
          <li>連投入信／画像のみ入信の<strong>判定改善</strong>。</li>
          <li><strong>500件超</strong>の安定稼働 → <strong>毎朝自動実行</strong>フローへ拡張。</li>
          <li>PoCをもとに<strong>他領域へ横展開</strong>、MP全体のAccuracy可視化と改善。</li>
          <li>正しい実績に基づく<strong>誤対応分析 → テンプレ/フロー改善案</strong>をOpsと共創。</li>
        </ul>
      </div>
    </section>

    <!-- ★ 新セクション①：スクショ縦積み＋箇条書き説明 -->
    <section class="reveal" id="flow-explain" style="width:100%;max-width:1080px;background:#ffffff;border-radius:20px;padding:60px 40px;margin-top:0;margin-bottom:60px;box-shadow:0 6px 20px rgba(0,0,0,0.08);">
      <h2 style="font-size:32px;font-weight:800;margin:0 0 24px;text-align:center;color:#111;">
        実行フローのイメージ
      </h2>

      <!-- ステップ1 -->
      <div class="stack-box">
        <img src="flow-1.png" alt="ステップ1の画面" class="stack-img">
        <ul class="stack-caption">
          <li>AI判定の出力をスプシに自動反映（個人情報保護フォルダ内）。</li>
          <li>各行に <strong>pass/fail</strong> と補足テキストを記載。</li>
        </ul>
      </div>

      <!-- ステップ2 -->
      <div class="stack-box">
        <img src="flow-2.png" alt="ステップ2の画面" class="stack-img">
        <ul class="stack-caption">
          <li>集計・サマリを自動生成。</li>
          <li>Modify診断や評価サマリを一括で確認可能。</li>
        </ul>
      </div>

      <!-- ステップ3 -->
      <div class="stack-box">
        <img src="flow-3.png" alt="ステップ3の画面" class="stack-img">
        <ul class="stack-caption">
          <li>完了時は <strong>bot</strong> がSlackへ通知。</li>
          <li>ワンクリック実行 → 放置でOK。</li>
        </ul>
      </div>
    </section>

    <!-- ★ 新セクション②：GASコード（折りたたみ） -->
    <section class="reveal" id="gas-codes" style="width:100%;max-width:1080px;background:#ffffff;border-radius:20px;padding:60px 40px;margin-top:0;margin-bottom:60px;box-shadow:0 6px 20px rgba(0,0,0,0.08);">
      <h2 style="font-size:32px;font-weight:800;margin:0 0 24px;text-align:center;color:#111;">
        運用GAS（主要スニペット）
      </h2>

      <ul style="margin:0 0 0 18px;color:#333;line-height:1.8;">
        <li><strong>抽出バッチ：</strong> 前日の入信/返信文をPII保護フォルダへ自動抽出。</li>
      </ul>
      <details>
        <summary>抽出バッチ（dailyExtract.gs）</summary>
        <pre class="codebox"><code>// 前日のメッセージを抽出し、保護フォルダへ保存
function dailyExtract() {
  const folderId = 'YOUR_SECURE_FOLDER_ID';
  const sheetId  = 'YOUR_SHEET_ID';
  const rangeA1  = 'A:F';

  const sheet = SpreadsheetApp.openById(sheetId).getActiveSheet();
  const values = sheet.getRange(rangeA1).getDisplayValues().slice(1);

  const today = new Date();
  const yday  = new Date(today.getFullYear(), today.getMonth(), today.getDate()-1);

  const dst = DriveApp.getFolderById(folderId);
  const out = values.filter(r => r[0] && new Date(r[0]).toDateString() === yday.toDateString());

  const file = dst.createFile(`extract_${Utilities.formatDate(yday, Session.getScriptTimeZone(), 'yyyyMMdd')}.json`,
                              JSON.stringify(out), MimeType.JSON);
  Logger.log('saved: ' + file.getName());
}</code></pre>
      </details>

      <ul style="margin:16px 0 0 18px;color:#333;line-height:1.8;">
        <li><strong>LLM判定ワーカー：</strong> 事前整形 → API投げ → スプシへ結果書き戻し。</li>
      </ul>
      <details>
        <summary>判定ワーカー（judgeWorker.gs）</summary>
        <pre class="codebox"><code>// テキスト整形 → LLM呼び出し → 結果をシートへ反映
function judgeWorker() {
  const sheet = SpreadsheetApp.openById('YOUR_SHEET_ID').getSheetByName('inbox');
  const rows  = sheet.getDataRange().getValues();
  const header = rows.shift();

  rows.forEach((r, idx) => {
    const input = preProcess_(r[1] + '\n' + r[2]); // 入信+返信文
    const resp  = callLLM_(input);
    const line  = idx + 2;
    sheet.getRange(line, 7).setValue(resp.score);     // 例: スコア
    sheet.getRange(line, 8).setValue(resp.summary);   // 例: サマリ
    sheet.getRange(line, 9).setValue(resp.modidy);    // 例: Modify診断
  });
}

function preProcess_(text) {
  return text.replace(/\s+/g,' ').trim().slice(0, 12000); // 送信前圧縮
}

function callLLM_(content) {
  const url = 'https://api.openai.com/v1/chat/completions';
  const payload = {
    model: 'gpt-4o-mini',
    messages: [{role:'system', content:'あなたはCS品質の判定者です。'},
               {role:'user',   content}]
  };
  const res = UrlFetchApp.fetch(url, {
    method:'post',
    contentType:'application/json',
    payload: JSON.stringify(payload),
    headers:{ Authorization:'Bearer ' + PropertiesService.getScriptProperties().getProperty('OPENAI_API_KEY') },
    muteHttpExceptions:true
  });
  const json = JSON.parse(res);
  // 返却例は環境に合わせて整形
  return { score: json.choices?.[0]?.message?.content ?? '', summary:'...', modidy:'...' };
}</code></pre>
      </details>

      <ul style="margin:16px 0 0 18px;color:#333;line-height:1.8;">
        <li><strong>Slack通知：</strong> 完了時にチャンネルへカード通知。</li>
      </ul>
      <details>
        <summary>Slack通知（notifySlack.gs）</summary>
        <pre class="codebox"><code>// Incoming Webhookで通知
function notifySlack_(text) {
  const url = PropertiesService.getScriptProperties().getProperty('SLACK_WEBHOOK');
  const payload = { text: ':robot_face: *EG PaymentのAudit 完了* :tada:\n' + text };
  UrlFetchApp.fetch(url, {
    method: 'post',
    contentType:'application/json',
    payload: JSON.stringify(payload)
  });
}</code></pre>
      </details>
    </section>

    <!-- おまけ（このページの作り方） -->
    <section class="reveal" id="how-made" style="width:100%;max-width:1080px;
      background:#ffffff; /* セクション外枠は白 */
      border-radius:20px;padding:60px 40px;margin-top:0;margin-bottom:60px;
      box-shadow:0 6px 20px rgba(0,0,0,0.08);">
      <h2 style="font-size:32px;font-weight:800;margin:0 0 40px;text-align:center;color:#111;">
        おまけ（このページの作り方）
      </h2>

      <!-- 内部ウィンドウは“以前の全体背景グラデ”を適用 -->
      <div style="background:linear-gradient(180deg, #dff3ff 0%, #ffffff 40%, #dff3ff 70%, #ffffff 100%);
                  border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,0.06);
                  padding:28px 36px;margin-bottom:28px;color:#10324a;">
        <h3 style="margin:0 0 10px;font-size:20px;border-left:6px solid #10324a;padding-left:10px;">タイトルバナー：Gemini</h3>
        <ul style="margin:8px 0 0 18px;line-height:1.8;">
          <li><strong>プロンプト：</strong>「非エンジニアでもAIでココまでできる」というタイトルで、横長のWeb用バナーを、添付の人物画像を含めて作って</li>
          <li><strong>添付資料：</strong>自分の顔画像も添付</li>
        </ul>
      </div>

      <div style="background:linear-gradient(180deg, #dff3ff 0%, #ffffff 40%, #dff3ff 70%, #ffffff 100%);
                  border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,0.06);
                  padding:28px 36px;margin-bottom:28px;color:#10324a;">
        <h3 style="margin:0 0 10px;font-size:20px;border-left:6px solid #10324a;padding-left:10px;">漫画草案：chatGPT5</h3>
        <ul style="margin:8px 0 0 18px;line-height:1.8;">
          <li><strong>プロンプト：</strong>添付のDocsの内容で、1ページ1コマ、全6ページの漫画を作りたい。プロット、コマ割りを考えて</li>
          <li><strong>添付資料：</strong>WBRでシェアしたdocs</li>
        </ul>
      </div>

      <div style="background:linear-gradient(180deg, #dff3ff 0%, #ffffff 40%, #dff3ff 70%, #ffffff 100%);
                  border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,0.06);
                  padding:28px 36px;color:#10324a;">
        <h3 style="margin:0 0 10px;font-size:20px;border-left:6px solid #10324a;padding-left:10px;">漫画画像：Gemini</h3>
        <ul style="margin:8px 0 0 18px;line-height:1.8;">
          <li><strong>プロンプト：</strong>以下のプロット、コマ割りで、LP風に漫画を作って</li>
        </ul>
      </div>
    </section>
  </main>

  <script>
    const io = new IntersectionObserver((entries) => {
      entries.forEach((e) => {
        if (e.isIntersecting && e.intersectionRatio >= 0.2) {
          e.target.classList.add('is-in');
        } else {
          if (e.intersectionRatio < 0.1) {
            e.target.classList.remove('is-in');
          }
        }
      });
    }, {
      threshold: [0, 0.1, 0.2, 0.6],
      rootMargin: "0px 0px -5% 0px"
    });
    document.querySelectorAll('.reveal').forEach(el => io.observe(el));
  </script>
</body>
</html>
